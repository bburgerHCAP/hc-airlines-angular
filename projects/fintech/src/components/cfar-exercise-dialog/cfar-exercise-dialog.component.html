<div mat-dialog-title class="p-32" ngClass.lt-md="px-16" fxLayout="row wrap" fxLayout="start center">
    
    <div fxFlex="80" fxLayoutAlign="center start" fxLayout="column">
        <h2 class="m-0">Cancel flight</h2>
    </div>
    <div fxFlex="20" fxLayoutAlign="end start">
        <button mat-mini-fab matTooltip="Close" (click)="onClose()">
            <mat-icon>clear</mat-icon>
        </button>
    </div>

</div>

<mat-dialog-content class="mat-typography">
  
    <div class="p-32" ngClass.lt-md="px-16" fxLayout="row wrap" fxLayoutAlign="start center">
        
        <div fxFlex="100" fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="8px" class="mb-16">
            <mat-icon color="primary">cached</mat-icon>
            <span class="title">Cancel For Any Reason</span>
        </div>

        <div fxFlex="100">
            <p>Cancel your booking free of charge until <b>{{ cfarContract?.expiryDateTime | date: 'EEEE, MMMM d, y, h:mm:ss a z' }}</b></p>
            <p>You'll receive a confirmation email and the trip status will be updated.</p>
        </div>

    </div>

    <mat-divider></mat-divider>

    <div class="p-32" ngClass.lt-md="px-16" fxLayout="row" fxLayoutAlign="start start">
        <div fxFlex fxLayout="column" fxLayoutAlign="center start">
            
            <ng-container *ngFor="let slice of cfarContract?.itinerary?.slices">

                <ng-container *ngFor="let segment of slice?.segments">
                    
                    <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="8px" class="mb-16">
                        <mat-icon color="primary" class="rotate-90">flight</mat-icon>
                        <span class="subtitle">{{ segment?.originAirport }} to {{ segment?.destinationAirport }}</span>
                    </div>
        
                    <div class="ml-32">
                        <p><b>Departure :</b> {{ segment?.departureDateTime | date: 'dd/MM/yyyy hh:mm' }}</p>
                        <p><b>Arrival :</b> {{ segment?.arrivalDateTime | date: 'dd/MM/yyyy hh:mm' }}</p>
                        <p><b>Flight :</b> {{ segment?.flightNumber }}</p>
                    </div>

                </ng-container>
                
            </ng-container>

        </div>

        <div fxFlex fxLayout="column" fxLayoutAlign="center start">
            <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="8px" class="mb-16">
                <mat-icon color="primary">person</mat-icon>
                <span class="subtitle" *ngIf="getNbPassengers(cfarContract.itinerary) <= 1">{{ getNbPassengers(cfarContract.itinerary) }} passenger</span>
                <span class="subtitle" *ngIf="getNbPassengers(cfarContract.itinerary) > 1">{{ getNbPassengers(cfarContract.itinerary) }} passengers</span>
            </div>

            <div class="ml-32">
                <p *ngFor="let passenger of getMapPassengers(cfarContract.itinerary) | keyvalue">
                    <b class="passenger-type">{{ passenger?.key }}</b> : {{ passenger?.value }}
                </p>
            </div>
        </div>
    </div>

    <mat-divider></mat-divider>

    <div class="p-32" ngClass.lt-md="px-16" fxLayout="row wrap" fxLayoutAlign="center center">

        <div fxFlex="100" fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="8px" class="mb-16">
            <mat-icon color="primary">monetization_on</mat-icon>
            <span class="subtitle">Choose your refund type</span>
        </div>
        
        <div fxFlex="100" fxLayout="row wrap" fxLayoutAlign="center center" fxLayout.lt-md="column">

            <ng-container *ngIf="cfarContract?.contractExercise?.hopperRefundMethod">

                <mat-card class="m-16 pointer" fxFlex fxLayout="row wrap"
                    [ngClass]="{ 'active': isHopperRefund }"
                    [ngClass.lt-md]="{ 'active': isHopperRefund, 'full-width': true }"
                    (click)="onSelectRefundType('hopper')">
                    <div fxFlex="100">
                        <h3 class="offer-title">Hopper refund</h3>
                        <p>Method : {{ cfarContract?.contractExercise?.hopperRefundMethod }}</p>
                        <p>Amount : {{ cfarContract?.contractExercise?.hopperRefund }}</p>
                    </div>
                </mat-card>

            </ng-container>

            <ng-container *ngIf="cfarContract?.contractExercise?.airlineRefundMethod">

                <mat-card class="m-16 pointer" fxFlex fxLayout="row wrap"
                    [ngClass]="{ 'active': !isHopperRefund }"
                    [ngClass.lt-md]="{ 'active': !isHopperRefund, 'full-width': true }"
                    (click)="onSelectRefundType('airline')">
                    <div fxFlex="100">
                        <h3 class="offer-title">Airline refund</h3>
                        <p>Method : {{ cfarContract?.contractExercise?.airlineRefundMethod }}</p>
                        <p>Amount : {{ cfarContract?.contractExercise?.airlineRefundAllowance }}</p>
                    </div>
                </mat-card>

            </ng-container>
            
        </div>
    
    </div>

    <mat-divider></mat-divider>

    <div class="p-32" ngClass.lt-md="px-16" fxLayout="row wrap" fxLayoutAlign="center center">

        <div fxFlex="100" fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="8px" class="mb-16">
            <mat-icon color="primary">credit_card</mat-icon>
            <span class="subtitle">Refund method</span>
        </div>

        <mat-form-field fxFlex="100" appearance="outline">
            <mat-select>
              <mat-option *ngFor="let refundMethod of refundMethods" (change)="onSelectRefundMethod(refundMethod)" [value]="refundMethod.value">
                {{ refundMethod?.label }}
              </mat-option>
            </mat-select>
        </mat-form-field>

    </div>
    
</mat-dialog-content>

<mat-dialog-actions>

    <div class="p-32" ngClass.lt-md="px-16" fxFlex="100" fxLayout="row wrap" fxLayout.lt-sm="column" fxLayoutAlign="end center">
        <button mat-button color="primary" ngClass.lt-sm="full-width" (click)="onClose()">Cancel</button>
        <button mat-flat-button color="primary" ngClass.lt-sm="full-width" (click)="onSubmit()">Submit</button>
    </div>
  
</mat-dialog-actions>